package me.maxwell.common.utils.postgre.explain;

import org.junit.Test;

import static org.junit.Assert.*;

public class ExplainPlanParserTest {

    @Test
    public void parse() {
        String txt = "{\"Plan\":{\"Node Type\":\"Limit\",\"Slice\":0,\"Segments\":0,\"Gang Type\":\"unallocated\",\"Startup Cost\":0,\"Total Cost\":3534.81,\"Plan Rows\":8,\"Plan Width\":11,\"Actual Startup Time\":2728.351,\"Actual Total Time\":2728.379,\"Actual Rows\":52,\"Actual Loops\":1,\"Plans\":[{\"Node Type\":\"Gather Motion\",\"Senders\":2,\"Receivers\":1,\"Parent Relationship\":\"Outer\",\"Slice\":11,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":3534.81,\"Plan Rows\":8,\"Plan Width\":11,\"Actual Startup Time\":2728.324,\"Actual Total Time\":2728.332,\"Actual Rows\":52,\"Actual Loops\":1,\"Merge Key\":[\"(count((count())))\"],\"Plans\":[{\"Node Type\":\"Sort\",\"Parent Relationship\":\"Outer\",\"Slice\":11,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":3534.81,\"Plan Rows\":8,\"Plan Width\":11,\"Actual Startup Time\":2724.726,\"Actual Total Time\":2724.728,\"Actual Rows\":29,\"Actual Loops\":1,\"Sort Key\":[\"(count((count())))\"],\"Sort Method\":\"quicksort\",\"Sort Space Used\":66,\"Sort Space Type\":\"Memory\",\"Plans\":[{\"Node Type\":\"Result\",\"Parent Relationship\":\"Outer\",\"Slice\":11,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":3534.81,\"Plan Rows\":8,\"Plan Width\":11,\"Actual Startup Time\":2724.347,\"Actual Total Time\":2724.376,\"Actual Rows\":29,\"Actual Loops\":1,\"Filter\":\"((count((count()))) >= 10)\",\"Rows Removed by Filter\":0,\"Plans\":[{\"Node Type\":\"Aggregate\",\"Strategy\":\"Hashed\",\"Parent Relationship\":\"Outer\",\"Slice\":11,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":3534.81,\"Plan Rows\":20,\"Plan Width\":19,\"Actual Startup Time\":2724.34,\"Actual Total Time\":2724.361,\"Actual Rows\":29,\"Actual Loops\":1,\"Group Key\":[\"customer_address.ca_state\"],\"Extra Text\":[{\"Extra Text\":\"(seg1)   Hash chain length 1.7 avg, 3 max, using 17 of 32 buckets; total 0 expansions.\\n\"}],\"Plans\":[{\"Node Type\":\"Redistribute Motion\",\"Senders\":2,\"Receivers\":2,\"Parent Relationship\":\"Outer\",\"Slice\":10,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":3534.81,\"Plan Rows\":20,\"Plan Width\":19,\"Actual Startup Time\":2710.763,\"Actual Total Time\":2724.216,\"Actual Rows\":58,\"Actual Loops\":1,\"Hash Key\":\"customer_address.ca_state\",\"Plans\":[{\"Node Type\":\"Result\",\"Parent Relationship\":\"Outer\",\"Slice\":10,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":3534.81,\"Plan Rows\":20,\"Plan Width\":19,\"Actual Startup Time\":2678.432,\"Actual Total Time\":2710.518,\"Actual Rows\":52,\"Actual Loops\":1,\"Plans\":[{\"Node Type\":\"Aggregate\",\"Strategy\":\"Sorted\",\"Parent Relationship\":\"Outer\",\"Slice\":10,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":3534.81,\"Plan Rows\":20,\"Plan Width\":19,\"Actual Startup Time\":2678.432,\"Actual Total Time\":2710.505,\"Actual Rows\":52,\"Actual Loops\":1,\"Group Key\":[\"customer_address.ca_state\"],\"Plans\":[{\"Node Type\":\"Sort\",\"Parent Relationship\":\"Outer\",\"Slice\":10,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":3534.81,\"Plan Rows\":20,\"Plan Width\":3,\"Actual Startup Time\":2678.15,\"Actual Total Time\":2687.767,\"Actual Rows\":129910,\"Actual Loops\":1,\"Sort Key\":[\"customer_address.ca_state\"],\"Sort Method\":\"quicksort\",\"Sort Space Used\":38898,\"Sort Space Type\":\"Memory\",\"Plans\":[{\"Node Type\":\"Hash Join\",\"Parent Relationship\":\"Outer\",\"Slice\":10,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Join Type\":\"Inner\",\"Startup Cost\":0,\"Total Cost\":3534.81,\"Plan Rows\":20,\"Plan Width\":3,\"Actual Startup Time\":2423.426,\"Actual Total Time\":2618.156,\"Actual Rows\":129910,\"Actual Loops\":1,\"Hash Cond\":\"(customer_address.ca_address_sk = customer.c_current_addr_sk)\",\"Extra Text\":[{\"Extra Text\":\"(seg0)   Hash chain length 1.9 avg, 12 max, using 68916 of 1048576 buckets.Hash chain length 1.8 avg, 11 max, using 71374 of 524288 buckets.Hash chain length 27.7 avg, 110 max, using 48751 of 524288 buckets.Hash chain length 1.0 avg, 1 max, using 10 of 262144 buckets.Hash chain length 1.0 avg, 1 max, using 6 of 32 buckets; total 0 expansions.\\n\"}],\"Plans\":[{\"Node Type\":\"Seq Scan\",\"Parent Relationship\":\"Outer\",\"Slice\":10,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Relation Name\":\"customer_address\",\"Alias\":\"customer_address\",\"Startup Cost\":0,\"Total Cost\":464,\"Plan Rows\":1000000,\"Plan Width\":7,\"Actual Startup Time\":0.273,\"Actual Total Time\":64.089,\"Actual Rows\":500237,\"Actual Loops\":1},{\"Node Type\":\"Hash\",\"Parent Relationship\":\"Inner\",\"Slice\":10,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":2975.26,\"Total Cost\":2975.26,\"Plan Rows\":20,\"Plan Width\":4,\"Actual Startup Time\":2419.388,\"Actual Total Time\":2419.388,\"Actual Rows\":129910,\"Actual Loops\":1,\"Plans\":[{\"Node Type\":\"Redistribute Motion\",\"Senders\":2,\"Receivers\":2,\"Parent Relationship\":\"Outer\",\"Slice\":9,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":2975.26,\"Plan Rows\":20,\"Plan Width\":4,\"Actual Startup Time\":2021.238,\"Actual Total Time\":2390.817,\"Actual Rows\":129910,\"Actual Loops\":1,\"Hash Key\":\"customer.c_current_addr_sk\",\"Plans\":[{\"Node Type\":\"Hash Join\",\"Parent Relationship\":\"Outer\",\"Slice\":9,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Join Type\":\"Inner\",\"Startup Cost\":0,\"Total Cost\":2975.26,\"Plan Rows\":20,\"Plan Width\":4,\"Actual Startup Time\":2015.332,\"Actual Total Time\":2377.762,\"Actual Rows\":129960,\"Actual Loops\":1,\"Hash Cond\":\"(customer.c_customer_sk = store_sales.ss_customer_sk)\",\"Extra Text\":[{\"Extra Text\":\"(seg0)   Hash chain length 1.8 avg, 11 max, using 71374 of 524288 buckets.Hash chain length 27.7 avg, 110 max, using 48751 of 524288 buckets.Hash chain length 1.0 avg, 1 max, using 10 of 262144 buckets.Hash chain length 1.0 avg, 1 max, using 6 of 32 buckets; total 0 expansions.\\n\"}],\"Plans\":[{\"Node Type\":\"Seq Scan\",\"Parent Relationship\":\"Outer\",\"Slice\":9,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Relation Name\":\"customer\",\"Alias\":\"customer\",\"Startup Cost\":0,\"Total Cost\":500.85,\"Plan Rows\":2000000,\"Plan Width\":8,\"Actual Startup Time\":0.289,\"Actual Total Time\":136.414,\"Actual Rows\":1000278,\"Actual Loops\":1},{\"Node Type\":\"Hash\",\"Parent Relationship\":\"Inner\",\"Slice\":9,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":2280.86,\"Total Cost\":2280.86,\"Plan Rows\":20,\"Plan Width\":4,\"Actual Startup Time\":2011.842,\"Actual Total Time\":2011.842,\"Actual Rows\":129960,\"Actual Loops\":1,\"Plans\":[{\"Node Type\":\"Redistribute Motion\",\"Senders\":2,\"Receivers\":2,\"Parent Relationship\":\"Outer\",\"Slice\":8,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":2280.86,\"Plan Rows\":20,\"Plan Width\":4,\"Actual Startup Time\":1683.642,\"Actual Total Time\":1976.338,\"Actual Rows\":136212,\"Actual Loops\":1,\"Hash Key\":\"store_sales.ss_customer_sk\",\"Plans\":[{\"Node Type\":\"Hash Join\",\"Parent Relationship\":\"Outer\",\"Slice\":8,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Join Type\":\"Inner\",\"Startup Cost\":0,\"Total Cost\":2280.86,\"Plan Rows\":20,\"Plan Width\":4,\"Actual Startup Time\":1684.906,\"Actual Total Time\":1980.04,\"Actual Rows\":133006,\"Actual Loops\":1,\"Hash Cond\":\"(item.i_item_sk = store_sales.ss_item_sk)\",\"Extra Text\":[{\"Extra Text\":\"(seg1)   Hash chain length 27.7 avg, 110 max, using 48751 of 524288 buckets.Hash chain length 1.0 avg, 1 max, using 10 of 262144 buckets.Hash chain length 1.0 avg, 1 max, using 6 of 32 buckets; total 0 expansions.\\n\"}],\"Plans\":[{\"Node Type\":\"Hash Join\",\"Parent Relationship\":\"Outer\",\"Slice\":8,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Join Type\":\"Inner\",\"Startup Cost\":0,\"Total Cost\":949.46,\"Plan Rows\":81600,\"Plan Width\":4,\"Actual Startup Time\":1.946,\"Actual Total Time\":93.504,\"Actual Rows\":10174,\"Actual Loops\":1,\"Hash Cond\":\"((item.i_category)::text = (item_1.i_category)::text)\",\"Join Filter\":\"(item.i_current_price > (1.2 * (pg_catalog.avg((avg(item_1.i_current_price))))))\",\"Rows Removed by Join Filter\":0,\"Extra Text\":[{\"Extra Text\":\"(seg1)   Hash chain length 1.0 avg, 1 max, using 10 of 262144 buckets.Hash chain length 1.0 avg, 1 max, using 6 of 32 buckets; total 0 expansions.\\n\"}],\"Plans\":[{\"Node Type\":\"Seq Scan\",\"Parent Relationship\":\"Outer\",\"Slice\":8,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Relation Name\":\"item\",\"Alias\":\"item\",\"Startup Cost\":0,\"Total Cost\":447.16,\"Plan Rows\":204000,\"Plan Width\":16,\"Actual Startup Time\":0.251,\"Actual Total Time\":19.794,\"Actual Rows\":102036,\"Actual Loops\":1},{\"Node Type\":\"Hash\",\"Parent Relationship\":\"Inner\",\"Slice\":8,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":462.24,\"Total Cost\":462.24,\"Plan Rows\":22,\"Plan Width\":14,\"Actual Startup Time\":0.022,\"Actual Total Time\":0.022,\"Actual Rows\":10,\"Actual Loops\":1,\"Plans\":[{\"Node Type\":\"Broadcast Motion\",\"Senders\":2,\"Receivers\":2,\"Parent Relationship\":\"Outer\",\"Slice\":2,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":462.24,\"Plan Rows\":22,\"Plan Width\":14,\"Actual Startup Time\":0.005,\"Actual Total Time\":0.008,\"Actual Rows\":11,\"Actual Loops\":1,\"Plans\":[{\"Node Type\":\"Result\",\"Parent Relationship\":\"Outer\",\"Slice\":2,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":462.23,\"Plan Rows\":11,\"Plan Width\":14,\"Actual Startup Time\":54.733,\"Actual Total Time\":54.758,\"Actual Rows\":6,\"Actual Loops\":1,\"Plans\":[{\"Node Type\":\"Aggregate\",\"Strategy\":\"Hashed\",\"Parent Relationship\":\"Outer\",\"Slice\":2,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":462.23,\"Plan Rows\":11,\"Plan Width\":14,\"Actual Startup Time\":54.732,\"Actual Total Time\":54.755,\"Actual Rows\":6,\"Actual Loops\":1,\"Group Key\":[\"item_1.i_category\"],\"Extra Text\":[{\"Extra Text\":\"(seg0)   Hash chain length 1.0 avg, 1 max, using 6 of 32 buckets; total 0 expansions.\\n\"}],\"Plans\":[{\"Node Type\":\"Redistribute Motion\",\"Senders\":2,\"Receivers\":2,\"Parent Relationship\":\"Outer\",\"Slice\":1,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":462.23,\"Plan Rows\":11,\"Plan Width\":14,\"Actual Startup Time\":44.119,\"Actual Total Time\":54.532,\"Actual Rows\":12,\"Actual Loops\":1,\"Hash Key\":\"item_1.i_category\",\"Plans\":[{\"Node Type\":\"Result\",\"Parent Relationship\":\"Outer\",\"Slice\":1,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":462.23,\"Plan Rows\":11,\"Plan Width\":14,\"Actual Startup Time\":44.859,\"Actual Total Time\":44.891,\"Actual Rows\":11,\"Actual Loops\":1,\"Plans\":[{\"Node Type\":\"Aggregate\",\"Strategy\":\"Hashed\",\"Parent Relationship\":\"Outer\",\"Slice\":1,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":462.23,\"Plan Rows\":11,\"Plan Width\":14,\"Actual Startup Time\":44.859,\"Actual Total Time\":44.89,\"Actual Rows\":11,\"Actual Loops\":1,\"Group Key\":[\"item_1.i_category\"],\"Extra Text\":[{\"Extra Text\":\"(seg0)   Hash chain length 1.2 avg, 2 max, using 9 of 32 buckets; total 0 expansions.\\n\"}],\"Plans\":[{\"Node Type\":\"Seq Scan\",\"Parent Relationship\":\"Outer\",\"Slice\":1,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Relation Name\":\"item\",\"Alias\":\"item_1\",\"Startup Cost\":0,\"Total Cost\":447.16,\"Plan Rows\":204000,\"Plan Width\":12,\"Actual Startup Time\":0.283,\"Actual Total Time\":14.833,\"Actual Rows\":102036,\"Actual Loops\":1}]}]}]}]}]}]}]}]},{\"Node Type\":\"Hash\",\"Parent Relationship\":\"Inner\",\"Slice\":8,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":1324.2,\"Total Cost\":1324.2,\"Plan Rows\":50,\"Plan Width\":8,\"Actual Startup Time\":1679.767,\"Actual Total Time\":1679.767,\"Actual Rows\":1351924,\"Actual Loops\":1,\"Plans\":[{\"Node Type\":\"Redistribute Motion\",\"Senders\":2,\"Receivers\":2,\"Parent Relationship\":\"Outer\",\"Slice\":7,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":1324.2,\"Plan Rows\":50,\"Plan Width\":8,\"Actual Startup Time\":13.354,\"Actual Total Time\":1381.637,\"Actual Rows\":1351924,\"Actual Loops\":1,\"Hash Key\":\"store_sales.ss_item_sk\",\"Plans\":[{\"Node Type\":\"Hash Join\",\"Parent Relationship\":\"Outer\",\"Slice\":7,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Join Type\":\"Inner\",\"Startup Cost\":0,\"Total Cost\":1324.2,\"Plan Rows\":50,\"Plan Width\":8,\"Actual Startup Time\":18.549,\"Actual Total Time\":827.108,\"Actual Rows\":1348401,\"Actual Loops\":1,\"Hash Cond\":\"(store_sales.ss_sold_date_sk = date_dim.d_date_sk)\",\"Extra Text\":[{\"Extra Text\":\"(seg0)   Hash chain length 1.0 avg, 1 max, using 31 of 524288 buckets.\"}],\"Plans\":[{\"Node Type\":\"Dynamic Seq Scan\",\"Parent Relationship\":\"Outer\",\"Slice\":7,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Relation Name\":\"store_sales\",\"Alias\":\"store_sales\",\"Dynamic Scan Id\":1,\"Startup Cost\":0,\"Total Cost\":435.26,\"Plan Rows\":119949,\"Plan Width\":12,\"Actual Startup Time\":1.888,\"Actual Total Time\":383.735,\"Actual Rows\":1737826,\"Actual Loops\":1},{\"Node Type\":\"Hash\",\"Parent Relationship\":\"Inner\",\"Slice\":7,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":100,\"Total Cost\":100,\"Plan Rows\":100,\"Plan Width\":4,\"Actual Startup Time\":12.813,\"Actual Total Time\":12.813,\"Actual Rows\":31,\"Actual Loops\":1,\"Plans\":[{\"Node Type\":\"Partition Selector\",\"Parent Relationship\":\"Outer\",\"Slice\":7,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Relation\":\"store_sales\",\"Dynamic Scan Id\":1,\"Startup Cost\":10,\"Total Cost\":100,\"Plan Rows\":100,\"Plan Width\":4,\"Actual Startup Time\":11.133,\"Actual Total Time\":12.797,\"Actual Rows\":31,\"Actual Loops\":1,\"Plans\":[{\"Node Type\":\"Broadcast Motion\",\"Senders\":2,\"Receivers\":2,\"Parent Relationship\":\"Outer\",\"Slice\":6,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":876.74,\"Plan Rows\":61,\"Plan Width\":4,\"Actual Startup Time\":10.758,\"Actual Total Time\":12.364,\"Actual Rows\":31,\"Actual Loops\":1,\"Plans\":[{\"Node Type\":\"Hash Join\",\"Parent Relationship\":\"Outer\",\"Slice\":6,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Join Type\":\"Inner\",\"Startup Cost\":0,\"Total Cost\":876.74,\"Plan Rows\":30,\"Plan Width\":4,\"Actual Startup Time\":5.712,\"Actual Total Time\":10.015,\"Actual Rows\":20,\"Actual Loops\":1,\"Hash Cond\":\"(date_dim.d_month_seq = date_dim_1.d_month_seq)\",\"Extra Text\":[{\"Extra Text\":\"(seg1)   Hash chain length 1.0 avg, 1 max, using 1 of 262144 buckets.\"}],\"Plans\":[{\"Node Type\":\"Seq Scan\",\"Parent Relationship\":\"Outer\",\"Slice\":6,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Relation Name\":\"date_dim\",\"Alias\":\"date_dim\",\"Startup Cost\":0,\"Total Cost\":433.61,\"Plan Rows\":73049,\"Plan Width\":8,\"Actual Startup Time\":0.169,\"Actual Total Time\":4.566,\"Actual Rows\":36726,\"Actual Loops\":1},{\"Node Type\":\"Hash\",\"Parent Relationship\":\"Inner\",\"Slice\":6,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":436.06,\"Total Cost\":436.06,\"Plan Rows\":2,\"Plan Width\":4,\"Actual Startup Time\":0.025,\"Actual Total Time\":0.025,\"Actual Rows\":1,\"Actual Loops\":1,\"Plans\":[{\"Node Type\":\"Assert\",\"Parent Relationship\":\"Outer\",\"Slice\":6,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":436.06,\"Plan Rows\":2,\"Plan Width\":4,\"Actual Startup Time\":0.022,\"Actual Total Time\":0.023,\"Actual Rows\":1,\"Actual Loops\":1,\"Assert Cond\":\"((row_number() OVER (?)) = 1)\",\"Plans\":[{\"Node Type\":\"Broadcast Motion\",\"Senders\":1,\"Receivers\":2,\"Parent Relationship\":\"Outer\",\"Slice\":5,\"Segments\":0,\"Gang Type\":\"entry DB reader\",\"Startup Cost\":0,\"Total Cost\":436.06,\"Plan Rows\":107,\"Plan Width\":12,\"Actual Startup Time\":0.007,\"Actual Total Time\":0.008,\"Actual Rows\":1,\"Actual Loops\":1,\"Plans\":[{\"Node Type\":\"Result\",\"Parent Relationship\":\"Outer\",\"Slice\":5,\"Segments\":0,\"Gang Type\":\"entry DB reader\",\"Startup Cost\":0,\"Total Cost\":436.02,\"Plan Rows\":53,\"Plan Width\":12,\"Actual Startup Time\":5.528,\"Actual Total Time\":5.988,\"Actual Rows\":1,\"Actual Loops\":1,\"Plans\":[{\"Node Type\":\"WindowAgg\",\"Parent Relationship\":\"Outer\",\"Slice\":5,\"Segments\":0,\"Gang Type\":\"entry DB reader\",\"Startup Cost\":0,\"Total Cost\":436.02,\"Plan Rows\":53,\"Plan Width\":12,\"Actual Startup Time\":5.527,\"Actual Total Time\":5.987,\"Actual Rows\":1,\"Actual Loops\":1,\"Plans\":[{\"Node Type\":\"Gather Motion\",\"Senders\":2,\"Receivers\":1,\"Parent Relationship\":\"Outer\",\"Slice\":4,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":436.02,\"Plan Rows\":53,\"Plan Width\":4,\"Actual Startup Time\":5.498,\"Actual Total Time\":5.954,\"Actual Rows\":1,\"Actual Loops\":1,\"Plans\":[{\"Node Type\":\"Aggregate\",\"Strategy\":\"Sorted\",\"Parent Relationship\":\"Outer\",\"Slice\":4,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":436.02,\"Plan Rows\":53,\"Plan Width\":4,\"Actual Startup Time\":0.333,\"Actual Total Time\":0.333,\"Actual Rows\":1,\"Actual Loops\":1,\"Group Key\":[\"date_dim_1.d_month_seq\"],\"Plans\":[{\"Node Type\":\"Sort\",\"Parent Relationship\":\"Outer\",\"Slice\":4,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":436.02,\"Plan Rows\":53,\"Plan Width\":4,\"Actual Startup Time\":0.327,\"Actual Total Time\":0.327,\"Actual Rows\":2,\"Actual Loops\":1,\"Sort Key\":[\"date_dim_1.d_month_seq\"],\"Sort Method\":\"quicksort\",\"Sort Space Used\":66,\"Sort Space Type\":\"Memory\",\"Plans\":[{\"Node Type\":\"Redistribute Motion\",\"Senders\":2,\"Receivers\":2,\"Parent Relationship\":\"Outer\",\"Slice\":3,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":436.02,\"Plan Rows\":53,\"Plan Width\":4,\"Actual Startup Time\":0.006,\"Actual Total Time\":0.007,\"Actual Rows\":2,\"Actual Loops\":1,\"Hash Key\":\"date_dim_1.d_month_seq\",\"Plans\":[{\"Node Type\":\"Aggregate\",\"Strategy\":\"Sorted\",\"Parent Relationship\":\"Outer\",\"Slice\":3,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":436.02,\"Plan Rows\":53,\"Plan Width\":4,\"Actual Startup Time\":4.163,\"Actual Total Time\":4.164,\"Actual Rows\":1,\"Actual Loops\":1,\"Group Key\":[\"date_dim_1.d_month_seq\"],\"Plans\":[{\"Node Type\":\"Sort\",\"Parent Relationship\":\"Outer\",\"Slice\":3,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Startup Cost\":0,\"Total Cost\":436.02,\"Plan Rows\":53,\"Plan Width\":4,\"Actual Startup Time\":4.104,\"Actual Total Time\":4.109,\"Actual Rows\":20,\"Actual Loops\":1,\"Sort Key\":[\"date_dim_1.d_month_seq\"],\"Sort Method\":\"quicksort\",\"Sort Space Used\":66,\"Sort Space Type\":\"Memory\",\"Plans\":[{\"Node Type\":\"Seq Scan\",\"Parent Relationship\":\"Outer\",\"Slice\":3,\"Segments\":2,\"Gang Type\":\"primary reader\",\"Relation Name\":\"date_dim\",\"Alias\":\"date_dim_1\",\"Startup Cost\":0,\"Total Cost\":436.02,\"Plan Rows\":53,\"Plan Width\":4,\"Actual Startup Time\":2.136,\"Actual Total Time\":3.765,\"Actual Rows\":20,\"Actual Loops\":1,\"Filter\":\"((d_year = 2001) AND (d_moy = 7))\",\"Rows Removed by Filter\":0}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},\"Planning Time\":912.341,\"Triggers\":null,\"Slice statistics\":[{\"Slice\":0,\"Executor Memory\":2638624},{\"Slice\":1,\"Executor Memory\":{\"Average\":431416,\"Workers\":2,\"Maximum Memory Used\":431416}},{\"Slice\":2,\"Executor Memory\":{\"Average\":156720,\"Workers\":2,\"Maximum Memory Used\":156720}},{\"Slice\":3,\"Executor Memory\":{\"Average\":439656,\"Workers\":2,\"Maximum Memory Used\":439656},\"Work Maximum Memory\":65752},{\"Slice\":4,\"Executor Memory\":{\"Average\":95448,\"Workers\":2,\"Maximum Memory Used\":95448},\"Work Maximum Memory\":65752},{\"Slice\":5,\"Executor Memory\":2041552},{\"Slice\":6,\"Executor Memory\":{\"Average\":2446648,\"Workers\":2,\"Maximum Memory Used\":2446648},\"Work Maximum Memory\":24},{\"Slice\":7,\"Executor Memory\":{\"Average\":5011240,\"Workers\":2,\"Maximum Memory Used\":5011240},\"Work Maximum Memory\":744},{\"Slice\":8,\"Executor Memory\":{\"Average\":73999976,\"Workers\":2,\"Maximum Memory Used\":73999976},\"Work Maximum Memory\":43261568},{\"Slice\":9,\"Executor Memory\":{\"Average\":13035016,\"Workers\":2,\"Maximum Memory Used\":13035016},\"Work Maximum Memory\":3119040},{\"Slice\":10,\"Executor Memory\":{\"Average\":37160128,\"Workers\":2,\"Maximum Memory Used\":37160128},\"Work Maximum Memory\":19914800},{\"Slice\":11,\"Executor Memory\":{\"Average\":189536,\"Workers\":2,\"Maximum Memory Used\":189536},\"Work Maximum Memory\":65752}],\"Statement statistics\":{\"Memory used\":393216},\"Settings\":{\"Optimizer\":\"Pivotal Optimizer (GPORCA) version 3.63.0\"},\"Execution Time\":2806.246}";

        ExplainPlan plan = ExplainPlanParser.parse(txt);
        System.out.println(plan);
    }

}